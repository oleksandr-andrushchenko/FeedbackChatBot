<?xml version="1.0" encoding="UTF-8" ?>
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>
        <service id="app.telegram_bot_remover" class="App\Service\Telegram\TelegramBotRemover" lazy="true"/>
        <service id="app.telegram_bot_info_provider" class="App\Service\Telegram\TelegramBotInfoProvider" lazy="true">
            <argument type="service" id="app.repository.telegram_payment_method"/>
        </service>
        <service id="app.telegram_bot_texts_info_provider" class="App\Service\Telegram\TelegramBotTextsInfoProvider"
                 lazy="true">
            <argument type="service" id="app.telegram_registry"/>
        </service>
        <service id="app.telegram_link_provider" class="App\Service\Telegram\TelegramLinkProvider" lazy="true"/>
        <service id="app.telegram_bot_validator" class="App\Service\Telegram\TelegramBotValidator" lazy="true">
            <argument type="service" id="app.repository.telegram_bot"/>
            <argument type="service" id="app.intl_country_provider"/>
        </service>
        <service id="app.telegram_bot_creator" class="App\Service\Telegram\TelegramBotCreator" lazy="true">
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <argument type="service" id="app.telegram_bot_validator"/>
        </service>
        <service id="app.telegram_bot_updater" class="App\Service\Telegram\TelegramBotUpdater" lazy="true">
            <argument type="service" id="app.intl_country_provider"/>
            <argument type="service" id="app.telegram_bot_validator"/>
        </service>
        <service id="app.telegram_webhook_url_generator" class="App\Service\Telegram\TelegramWebhookUrlGenerator"
                 lazy="true">
            <argument>%app.telegram_webhook_base_url%</argument>
            <argument>app.telegram_site_webhook</argument>
            <argument type="service" id="Symfony\Component\Routing\Generator\UrlGeneratorInterface"/>
        </service>
        <service id="app.telegram_client_factory" class="App\Service\Telegram\TelegramClientFactory" lazy="true"/>
        <service id="app.telegram_channel_factory" class="App\Service\Telegram\Channel\TelegramChannelFactory">
            <argument type="tagged_locator" tag="app.telegram_channel" index-by="channel"/>
        </service>
        <service id="app.telegram_conversation_factory_default"
                 class="App\Service\Telegram\Conversation\TelegramConversationFactory" lazy="true">
            <argument type="tagged_locator" tag="app.telegram_conversation_default"/>
        </service>
        <service id="app.telegram_factory" class="App\Service\Telegram\TelegramFactory" lazy="true">
            <argument type="service" id="app.telegram_client_registry"/>
            <argument type="service" id="app.telegram_request_checker"/>
            <argument type="service" id="logger"/>
        </service>
        <service id="app.telegram_active_conversation_invoker"
                 class="App\Service\Telegram\Conversation\TelegramActiveConversationInvoker" lazy="true">
            <argument type="service" id="app.telegram_conversation_manager"/>
        </service>
        <service id="app.telegram_conversation_manager"
                 class="App\Service\Telegram\Conversation\TelegramConversationManager" lazy="true">
            <argument type="service" id="app.telegram_aware_helper"/>
            <argument type="service" id="app.repository.telegram_conversation"/>
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <argument type="service" id="serializer"/>
            <argument type="service" id="serializer"/>
            <argument type="service" id="app.array_null_filter"/>
            <argument type="service" id="app.telegram_channel_registry"/>
            <argument type="service" id="app.telegram_chat_provider"/>
        </service>
        <service id="app.telegram_my_commands_provider" class="App\Service\Telegram\TelegramMyCommandsProvider"
                 lazy="true">
            <argument type="service" id="app.telegram_channel_registry"/>
        </service>
        <service id="app.telegram_webhook_updater" class="App\Service\Telegram\Api\TelegramWebhookUpdater" lazy="true">
            <argument type="service" id="app.telegram_registry"/>
            <argument type="service" id="app.telegram_webhook_url_generator"/>
        </service>
        <service id="app.telegram_webhook_remover" class="App\Service\Telegram\Api\TelegramWebhookRemover" lazy="true"/>
        <service id="app.telegram_webhook_info_provider" class="App\Service\Telegram\TelegramWebhookInfoProvider"
                 lazy="true">
            <argument type="service" id="app.telegram_registry"/>
        </service>
        <service id="app.telegram_user_provider" class="App\Service\Telegram\TelegramUserProvider" lazy="true"/>
        <service id="app.telegram_chat_provider" class="App\Service\Telegram\TelegramChatProvider" lazy="true"/>
        <service id="app.telegram_input_provider" class="App\Service\Telegram\TelegramInputProvider" lazy="true"/>
        <service id="app.telegram_messenger_user_upserter" class="App\Service\Telegram\TelegramMessengerUserUpserter"
                 lazy="true">
            <argument type="service" id="app.telegram_user_provider"/>
            <argument type="service" id="app.messenger_user_upserter"/>
            <argument type="service" id="app.user_upserter"/>
            <argument type="service" id="app.intl_country_provider"/>
        </service>
        <service id="app.telegram_update_checker" class="App\Service\Telegram\TelegramUpdateChecker"
                 lazy="true">
            <argument type="service" id="app.repository.telegram_update"/>
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <argument type="service" id="logger"/>
        </service>
        <service id="app.telegram_request_checker" class="App\Service\Telegram\TelegramRequestChecker"
                 lazy="true">
            <argument type="service" id="app.repository.telegram_request"/>
            <argument type="service" id="doctrine.orm.entity_manager"/>
        </service>
        <service id="app.telegram_non_admin_update_checker" class="App\Service\Telegram\TelegramNonAdminUpdateChecker"
                 lazy="true">
            <argument type="service" id="app.telegram_user_provider"/>
        </service>
        <service id="app.telegram_command_finder" class="App\Service\Telegram\Command\TelegramCommandFinder"
                 lazy="true"/>
        <service id="app.telegram_update_factory" class="App\Service\Telegram\TelegramUpdateFactory" lazy="true">
            <argument type="service" id="logger"/>
        </service>
        <service id="app.telegram_locale_switcher" class="App\Service\Telegram\TelegramLocaleSwitcher" lazy="true">
            <argument type="service" id="translation.locale_switcher"/>
            <argument type="service" id="app.intl_country_provider"/>
        </service>
        <service id="app.telegram_update_handler" class="App\Service\Telegram\TelegramUpdateHandler" lazy="true">
            <argument>%kernel.environment%</argument>
            <argument type="service" id="app.telegram_update_factory"/>
            <argument type="service" id="app.telegram_update_checker"/>
            <argument type="service" id="app.telegram_non_admin_update_checker"/>
            <argument type="service" id="app.telegram_conversation_manager"/>
            <argument type="service" id="app.telegram_messenger_user_upserter"/>
            <argument type="service" id="app.telegram_channel_registry"/>
            <argument type="service" id="app.telegram_command_finder"/>
            <argument type="service" id="app.telegram_payment_manager"/>
            <argument type="service" id="app.telegram_locale_switcher"/>
            <argument type="service" id="app.telegram_input_provider"/>
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <argument type="service" id="logger"/>
        </service>
        <service id="app.telegram_keyboard_factory" class="App\Service\Telegram\TelegramKeyboardFactory" lazy="true"/>
        <service id="app.telegram_commands_updater" class="App\Service\Telegram\Api\TelegramCommandsUpdater"
                 lazy="true">
            <argument type="service" id="app.translator"/>
            <argument type="service" id="app.telegram_my_commands_provider"/>
        </service>
        <service id="app.telegram_commands_remover" class="App\Service\Telegram\Api\TelegramCommandsRemover"
                 lazy="true">
            <argument type="service" id="app.telegram_my_commands_provider"/>
        </service>
        <service id="app.telegram_texts_updater" class="App\Service\Telegram\Api\TelegramTextsUpdater"
                 lazy="true">
            <argument>%app.stage%</argument>
            <argument type="service" id="app.telegram_registry"/>
            <argument type="service" id="app.site_url_generator"/>
            <argument type="service" id="app.translator"/>
        </service>
        <service id="app.telegram_message_sender" class="App\Service\Telegram\Api\TelegramMessageSender" lazy="true"/>
        <service id="app.telegram_chat_action_sender" class="App\Service\Telegram\Api\TelegramChatActionSender"
                 lazy="true"/>
        <service id="app.telegram_client_registry" class="App\Service\Telegram\TelegramClientRegistry" lazy="true">
            <argument type="service" id="app.telegram_client_factory"/>
        </service>
        <service id="app.telegram_channel_registry" class="App\Service\Telegram\Channel\TelegramChannelRegistry"
                 lazy="true">
            <argument type="service" id="app.telegram_channel_factory"/>
        </service>
        <service id="app.telegram_messenger_user_maker" class="App\Service\Telegram\TelegramMessengerUserMaker"
                 lazy="true"/>
        <service id="app.telegram_payment_manager_options_factory"
                 class="App\Service\Telegram\TelegramPaymentManagerOptionsFactory" lazy="true"/>
        <service id="app.telegram_payment_manager_options" class="App\Entity\Telegram\TelegramPaymentManagerOptions">
            <factory service="app.telegram_payment_manager_options_factory"/>
            <argument>%app.telegram_payment_manager_options%</argument>
        </service>
        <service id="app.telegram_payment_manager" class="App\Service\Telegram\Payment\TelegramPaymentManager"
                 lazy="true">
            <argument type="service" id="app.telegram_payment_manager_options"/>
            <argument type="service" id="app.telegram_invoice_sender"/>
            <argument type="service" id="app.intl_currency_provider"/>
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <argument type="service" id="app.repository.telegram_payment"/>
            <argument type="service" id="app.uuid_generator"/>
            <argument type="service" id="app.logger_activity"/>
        </service>
        <service id="app.telegram_registry" class="App\Service\Telegram\TelegramRegistry" lazy="true">
            <argument type="service" id="app.telegram_factory"/>
        </service>
        <service id="app.telegram_aware_helper" class="App\Service\Telegram\TelegramAwareHelper" lazy="true">
            <argument type="service" id="app.telegram_keyboard_factory"/>
            <argument type="service" id="app.telegram_message_sender"/>
            <argument type="service" id="app.translator"/>
            <argument type="service" id="app.telegram_conversation_manager"/>
            <argument type="service" id="app.telegram_chat_action_sender"/>
            <argument type="service" id="app.telegram_chat_provider"/>
            <argument type="service" id="app.telegram_input_provider"/>
            <argument type="service" id="twig"/>
        </service>
        <service id="app.telegram_invoice_sender" class="App\Service\Telegram\Api\TelegramInvoiceSender" lazy="true"/>
        <service id="app.telegram_payment_method_creator"
                 class="App\Service\Telegram\Payment\TelegramPaymentMethodCreator" lazy="true">
            <argument type="service" id="app.intl_currency_provider"/>
            <argument type="service" id="doctrine.orm.entity_manager"/>
        </service>
        <service id="app.telegram_payment_method_info_provider"
                 class="App\Service\Telegram\Payment\TelegramPaymentMethodInfoProvider" lazy="true"/>
        <service id="app.telegram_payment_method_provider"
                 class="App\Service\Telegram\Payment\TelegramPaymentMethodProvider" lazy="true">
            <argument type="service" id="translator"/>
        </service>
        <service id="app.better_match_telegram_bot_provider"
                 class="App\Service\Telegram\BetterMatchTelegramBotProvider" lazy="true">
            <argument type="service" id="app.repository.telegram_bot"/>
        </service>
        <service id="app.better_match_bot_telegram_chat_sender"
                 class="App\Service\Telegram\Chat\BetterMatchBotTelegramChatSender" lazy="true">
            <argument type="service" id="app.better_match_telegram_bot_provider"/>
            <argument type="service" id="app.intl_country_provider"/>
            <argument type="service" id="app.intl_locale_provider"/>
            <argument type="service" id="app.telegram_link_provider"/>
        </service>
        <service id="app.telegram_site_view_response_factory"
                 class="App\Service\Telegram\Site\TelegramSiteViewResponseFactory" lazy="true">
            <argument type="service" id="twig"/>
            <argument type="service" id="translation.locale_switcher"/>
            <argument type="service" id="app.intl_country_provider"/>
            <argument type="service" id="app.intl_locale_provider"/>
            <argument type="service" id="app.contact_options_factory"/>
            <argument type="service" id="app.repository.telegram_bot"/>
        </service>
    </services>
</container>