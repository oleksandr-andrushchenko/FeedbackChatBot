<?php

declare(strict_types=1);

namespace App\Service\Intl\Ukr;

/**
 * @see https://uk.wikipedia.org/wiki/%D0%A3%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D1%81%D1%8C%D0%BA%D1%96_%D0%BF%D1%80%D1%96%D0%B7%D0%B2%D0%B8%D1%89%D0%B0
 */
class UkrLastNameByNameFinder
{
    private const SUFFIXES = [
        'енко', 'єнко',
        'ко',
        'нько', 'анько', 'енько', 'єнько', 'инько', 'інько', 'онько', 'ьонько', 'унько', 'юнько', 'янько',
        'нька', 'анька', 'енька', 'инька', 'інька', 'онька', 'унька', 'юнька',
        'чко', 'ачко', 'ечко', 'єчко', 'ичко', 'ічко', 'їчко', 'очко', 'учко', 'ючко', 'ячко',
        'чка', 'ачка', 'ечка', 'єчка', 'ичка', 'ічка', 'їчка', 'очка', 'ьочка', 'учка', 'ючка', 'ячка',
        'исько', 'ісько',
        'иско', 'іско',
        'ий', 'ій',
        'ський', 'цький', 'зький',
        'овський', 'івський', 'евський', 'івський', 'євський', 'ївський',
        'ич', 'іч', 'їч',
        'ович', 'евич', 'євич',
        'ач', 'яч',
        'еч', 'єч',
        'оч',
        'уч', 'юч',
        'ук', 'юк',
        'нюк', 'нук',
        'чук', 'шук', 'щук',
        'ак', 'як',
        'нак', 'няк',
        'ик', 'ік', 'їк',
        'ник', 'нік',
        'ок', 'йок', 'ьок',
        'ів', 'ив', 'їв',
        'ов', 'ьов', 'йов', 'ьйов', 'ев', 'єв',
        'ув', 'юв',
        'ин', 'ін', 'їн',
        'ишин', 'ішин', 'ишін', 'ішін', 'їшин', 'їшін',
        'ешин', 'ьошин', 'йошин', 'ешін', 'єшин', 'єшін',
        'йшин', 'йшін',
        'шин', 'шін',
        'щин', 'щін ',
        'чин', 'чін',
        'жин', 'жін',
        'джин', 'джін',
        'дзин', 'дзін',
        'ен', 'єн',
        'ишен', 'ішен', 'їшен',
        'ешен', 'ьошен', 'єшен',
        'йшен',
        'шен',
        'щен',
        'чен',
        'джен',
        'дзен',
        'ин', 'ін', 'ен', 'їн',
        'ай', 'яй',
        'ей', 'єй',
        'ій', 'ий',
        'овцій',
        'ой',
        'уй', 'юй',
        'ая', 'яя',
        'ія', 'ея', 'ия', 'їя',
        'оя',
        'уя',
        'зь', 'з',
        'сь', 'с',
        'ась', 'есь', 'ись', 'ісь', 'ось', 'ьось', 'усь', 'юсь', 'ясь',
        'ць', 'ц',
        'ець', 'иць', 'іць', 'єць',
        'ця',
        'иця', 'іця',
        'оц', 'оць', 'ьоц', 'ьоць',
        'оца', 'оця',
        'уц', 'уць', 'юц', 'юць',
        'уца', 'уця', 'юца', 'юця',
        'х',
        'ах', 'ях',
        'ех', 'єх', 'их', 'іх', 'їх',
        'ох', 'йох', 'ьох',
        'ух', 'юх',
        'ла',
        'дла',
        'ля',
        'для',
        'ло',
        'дло',
        'йло', 'айло', 'ейло', 'ийло', 'ійло', 'ойло', 'уйло', 'яйло',
        'ойть', 'оіть', 'оїть', 'айть', 'ейть',
        'йш',
        'йша',
        'йшо',
        'ба',
        'ва',
        'да',
        'нда', 'ндо',
        'дя',
        'жа',
        'джа',
        'за',
        'зя',
        'дза',
        'дзо',
        'дзьо',
        'дзя',
        'ма',
        'па',
        'ра',
        'ря',
        'ша',
        'ар', 'яр', 'ер', 'єр', 'ир', 'ір', 'їр', 'ор', 'йор', 'ьор', 'ьйор', 'ур', 'юр',
        'аж', 'яж',
        'еж', 'єж',
        'иж', 'іж',
        'ож',
        'уж', 'юж',
        'аш', 'яш',
        'еш', 'єш',
        'иш', 'іш', 'їш',
        'ош', 'йош', 'ьош',
        'уш', 'юш',
        'аль', 'иль', 'іль', 'ель', 'яль',
        'оль',
        'уль', 'юль',
        'ан', 'ян',
        'ен', 'єн',
        'он',
        'іон', 'ьон', 'йон', 'ійон', 'ьйон', 'ион', 'ийон', 'ивон', 'івон', 'евон', 'еон', 'ейон',
        'ун', 'юн',
        'на',
        'ена', 'єна',
        'ина', 'іна', 'їна',
        'она',
        'ьона', 'иона', 'іона', 'еона',
        'ено', 'єно',
        'ня',
        'аня', 'яня',
        'еня', 'єня',
        'иня', 'іня', 'їня',
        'оня', 'ьоня',
        'уня', 'юня',
        'нь',
        'ань', 'янь',
        'ень', 'єнь',
        'инь', 'інь',
        'онь', 'ьонь',
        'унь', 'юнь',
        'га', 'ґа', 'го',
        'ка',
        'ака', 'ако', 'яка', 'яко',
        'ика', 'ико', 'іка', 'іко', 'їка', 'їко',
        'ука', 'уко', 'юка', 'юко',
        'та',
        'нта',
        'чта',
        'ута', 'юта',
        'то',
        'нто',
        'уто', 'юто',
        'тя',
        'ат',
        'ят',
        'чат', 'шат', 'щат див. «-ят»',
        'ет', 'єт',
        'еть',
        'ит', 'іт', 'їт',
        'от', 'йот', 'іот', 'ійот', 'ьот',
        'оть',
        'ут', 'ют',
        'уть', 'ють',
        'ха', 'хо',
        'е',
        'о', 'ьо', 'йо', 'ьйо',
        'но',
        'гно',
        'хно',
        'хна',
        'ас', 'яс', 'ес', 'ис', 'іс', 'їс', 'ос', 'йос', 'ьос', 'ус', 'юс',
        'из', 'із',
        'ч',
        'ча', 'чо',
        'еча', 'єча',
        'ща', 'що',
        'ого',
        'са',
        'еса', 'иса', 'іса', 'ьоса', 'йоса', 'іоса',
        'йса',
        'ся',
        'ися', 'іся',
        'йся',
        'ист', 'іст', 'їст',
        'иста', 'іста', 'їста',
        'нт',
        'ищ', 'іщ',
        'ища', 'іща', 'ище', 'іще',
        'дзь', 'дз',
        'вз', 'взь', 'лз',
        'вза', 'взо', 'лза', 'льза', 'льзо',
        'вт', 'вть', 'лт',
        'вта', 'втя', 'лта',
        'вх', 'лх',
        'им', 'ім', 'їм',
        'ем', 'єм',
        'вва', 'дда', 'жжа', 'зза', 'кка', 'лла', 'мма', 'ппа', 'сса', 'тта',
        'вво', 'ддо', 'кко', 'лло', 'ммо', 'ппо', 'ссо', 'тто',
        'ддя', 'лля', 'ння', 'рря', 'сся', 'ття',
    ];

    public function findLastNameByName(string $name): null|string|array
    {
        $output = [];

        $names = array_filter(array_map('trim', explode(' ', $name)));

        foreach ($names as $name) {
            foreach (self::SUFFIXES as $suffix) {
                if (str_ends_with($name, $suffix)) {
                    $output[] = $name;
                    break;
                }
            }
        }

        return count($output) === 0 ? null : (count($output) > 1 ? $output : $output[0]);
    }
}